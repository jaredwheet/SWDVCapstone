<!DOCTYPE html>
<html>

<head>
    <title>Home</title>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
</head>

<body>


    <div class="jumbotron jumbotron-fluid">
        <div class="container">
            <h1 class="display-4">Baby Tracker Login</h1>
            <p class="lead">Login or register from here to access.</p>
        </div>
    </div>

    <form>
        <div class="form-group">
            <label for="exampleInputEmail1">Email address</label>
            <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp"
                placeholder="Enter email">

        </div>
        <div class="form-group">
            <label for="exampleInputPassword1">Password</label>
            <input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
        </div>

        <button type="submit" class="btn btn-primary">Submit</button>
        <button type="button" class="btn btn-primary" onclick="window.location.href = '/register'">Register</button>
    </form>
    
    
    
    
    
    <!-- BELOW CODE IS CRITICAL. IT HANDLES HOW FORM DATA IS SENT TO OUR SERVER -->
    <script type="text/javascript">

        // In this code below we create the Front-end JavaScript which "POSTS" our form data to our express server.
        // In essence, when the user hits submit, jQuery grabs all of the fields then sends a post request to our api
        // Our api recognizes the route (/api/tables)... and then runs the associated code (found in api-routes.js).
        // In this case the associated code "saves" the data to the table-data.js file or waitinglist-data.js file

        $("#login").on("click", function (event) {
            event.preventDefault();
            // This is used to change button text, to indicated if feeding has been started.
            var $this = $(this);
            app.get("*", function (req, res) {
                res.sendFile(path.join(__dirname, "../public/index.html"));
            });


        });

        $("#sleep").on("click", function (event) {
            event.preventDefault();
            var sleepingStartTimestamp = moment().format('YYYY-MM-DD, hh:mm:ss')

            // This is used to change button text, to indicated if feeding has been started.
            var $this = $(this);
            $this.toggleClass('sleepingStarted');

            if ($this.hasClass('sleepingStarted')) {
                $this.text('End Sleeping');
                $this.on("click", function (event) {
                    var sleepingEndTimestamp = moment().format('YYYY-MM-DD, hh:mm:ss')
                    console.log(sleepingStartTimestamp, sleepingEndTimestamp)
                    var newSleepTimestamp = {
                        timeStart: sleepingStartTimestamp,
                        timeEnd: sleepingEndTimestamp,
                    };
                    $.post("/api/sleepData", newSleepTimestamp,
                        function (data) {
                            console.log(data)
                        });
                    location.reload();
                });

            }
            else {
                $this.text('Start Sleeping')


            }
        });

        $("#vitalsSubmit").on("click", function (event) {
            event.preventDefault();
            currentTime = moment().format('YYYY-MM-DD, hh:mm:ss')

            var newVitals = {
                timestamp: currentTime,
                height: parseFloat($("#height").val().trim()),
                weight: parseFloat($("#weight").val().trim()),
            };
            console.log("submitting vitals")
            console.log(newVitals)

            $.post("/api/vitalsData", newVitals,
                function (data) {
                    console.log(data)
                });
            $("#height").val("");
            $("#weight").val("");
            alert("Baby Vitals has been submitted and saved!")
        })


    </script>


</body>

</html>